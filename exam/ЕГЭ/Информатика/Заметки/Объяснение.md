
## ‚úÖ –ö–æ–¥ –¥–ª—è DAG:

```python
from collections import defaultdict, deque

def max_path_dag(graph, start):
    # 1. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω
    in_degree = defaultdict(int)
    all_vertices = set()
    for u in graph:
        all_vertices.add(u)
        for v, w in graph[u]:
            in_degree[v] += 1
            all_vertices.add(v)

    # 2. –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–∞–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ö–Ω–∞)
    queue = deque(v for v in all_vertices if in_degree[v] == 0)
    topo = []
    while queue:
        u = queue.popleft()
        topo.append(u)
        for v, w in graph.get(u, []):
            in_degree[v] -= 1
            if in_degree[v] == 0:
                queue.append(v)

    # 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
    dp = defaultdict(lambda: -10**9)  # "–º–∏–Ω—É—Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å"
    dp[start] = 0

    # 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –≤ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
    for u in topo:
        if dp[u] == -10**9:
            continue  # –Ω–µ –¥–æ—Å—Ç–∏–∂–∏–º–∞ –∏–∑ start
        for v, w in graph.get(u, []):
            if dp[u] + w > dp[v]:
                dp[v] = dp[u] + w

    return dp
```

---

## üß© –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ —à–∞–≥–∞–º:

---

## üîπ –®–∞–≥ 1: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω

```python
in_degree = defaultdict(int)
all_vertices = set()
for u in graph:
    all_vertices.add(u)
    for v, w in graph[u]:
        in_degree[v] += 1
        all_vertices.add(v)
```

### üí° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?

- `in_degree[v]` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä, **–≤—Ö–æ–¥—è—â–∏—Ö –≤ –≤–µ—Ä—à–∏–Ω—É `v`**.
- `all_vertices` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –≥—Ä–∞—Ñ–µ (–∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–ª–∏ —Å—Ç–æ–∫–∏).

### üìå –ü—Ä–∏–º–µ—Ä:

–ï—Å–ª–∏ –µ—Å—Ç—å —Ä—ë–±—Ä–∞:
```
7 ‚Üí 1 (–≤–µ—Å 1)
17 ‚Üí 1 (–≤–µ—Å 1)
```

‚Üí `in_degree[1] = 2` (–≤—Ö–æ–¥—è—â–∏–µ —Ä—ë–±—Ä–∞ –∏–∑ 7 –∏ 17).

---

## üîπ –®–∞–≥ 2: –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–∞–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ö–Ω–∞)

```python
queue = deque(v for v in all_vertices if in_degree[v] == 0)
topo = []
while queue:
    u = queue.popleft()
    topo.append(u)
    for v, w in graph.get(u, []):
        in_degree[v] -= 1
        if in_degree[v] == 0:
            queue.append(v)
```

### üí° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?

- –ù–∞—Ö–æ–¥–∏—Ç **–ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ—Ä—à–∏–Ω**, –≤ –∫–æ—Ç–æ—Ä–æ–º **–≤—Å–µ —Ä—ë–±—Ä–∞ –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ –≤–ø–µ—Ä—ë–¥** ‚Äî —Ç–æ –µ—Å—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–±—Ä–æ `u ‚Üí v`, —Ç–æ `u` –∏–¥—ë—Ç **—Ä–∞–Ω—å—à–µ** `v` –≤ —Å–ø–∏—Å–∫–µ `topo`.

### üìå –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

–ü–æ—Ç–æ–º—É —á—Ç–æ:

> **–ß—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –≤–µ—Ä—à–∏–Ω—ã `v`, –º—ã –¥–æ–ª–∂–Ω—ã —É–∂–µ –∑–Ω–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤ `v` –≤–µ–¥—É—Ç —Ä—ë–±—Ä–∞.**

üëâ –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–∫–æ–≥–¥–∞ –º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º `v`, –≤—Å–µ –µ—ë –ø—Ä–µ–¥—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã**.

### üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ö–Ω–∞?

1. –ù–∞—á–∏–Ω–∞–µ–º —Å –≤–µ—Ä—à–∏–Ω, —É –∫–æ—Ç–æ—Ä—ã—Ö **–≤—Ö–æ–¥—è—â–∞—è —Å—Ç–µ–ø–µ–Ω—å = 0** ‚Äî –æ–Ω–∏ **–Ω–µ –∑–∞–≤–∏—Å—è—Ç –Ω–∏ –æ—Ç –∫–æ–≥–æ** ‚Äî –∏—Ö –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–≤—ã–º–∏.
2. –ë–µ—Ä—ë–º —Ç–∞–∫—É—é –≤–µ—Ä—à–∏–Ω—É `u`, –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∏ **—É–º–µ–Ω—å—à–∞–µ–º –≤—Ö–æ–¥—è—â—É—é —Å—Ç–µ–ø–µ–Ω—å –≤—Å–µ—Ö –µ—ë —Å–æ—Å–µ–¥–µ–π `v`** (–ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–±—Ä–æ `u ‚Üí v` "—É–¥–∞–ª–µ–Ω–æ").
3. –ï—Å–ª–∏ —É –∫–∞–∫–æ–π-—Ç–æ –≤–µ—Ä—à–∏–Ω—ã `v` –≤—Ö–æ–¥—è—â–∞—è —Å—Ç–µ–ø–µ–Ω—å —Å—Ç–∞–ª–∞ 0 ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë –≤ –æ—á–µ—Ä–µ–¥—å.
4. –ü–æ–≤—Ç–æ—Ä—è–µ–º, –ø–æ–∫–∞ –æ—á–µ—Ä–µ–¥—å –Ω–µ –ø—É—Å—Ç–∞.

---

## üîπ –®–∞–≥ 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π

```python
dp = defaultdict(lambda: -10**9)
dp[start] = 0
```

### üí° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?

- `dp[v]` ‚Äî **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç `start` –¥–æ `v`**.
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–µ–º `-10**9` ‚Äî —ç—Ç–æ **"–º–∏–Ω—É—Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å"**, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–µ—Ä—à–∏–Ω–∞ **–Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–∞**.
- –¢–æ–ª—å–∫–æ —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞ –∏–º–µ–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ `0`.

---

## üîπ –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –≤ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ

```python
for u in topo:
    if dp[u] == -10**9:
        continue  # –Ω–µ –¥–æ—Å—Ç–∏–∂–∏–º–∞ –∏–∑ start
    for v, w in graph.get(u, []):
        if dp[u] + w > dp[v]:
            dp[v] = dp[u] + w
```

### üí° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?

- –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤–µ—Ä—à–∏–Ω–∞–º –≤ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ.
- –î–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã `u` ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –µ—ë —Å–æ—Å–µ–¥–µ–π `v`:
  ```
  dp[v] = max(dp[v], dp[u] + w)
  ```
- –¢–æ –µ—Å—Ç—å, **–µ—Å–ª–∏ –ø—É—Ç—å —á–µ—Ä–µ–∑ `u` –¥–ª–∏–Ω–Ω–µ–µ, —á–µ–º —Ç–µ–∫—É—â–∏–π ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º**.

### üìå –ü—Ä–∏–º–µ—Ä:

```
0 ‚Üí 1 (–≤–µ—Å 5)
0 ‚Üí 2 (–≤–µ—Å 3)
1 ‚Üí 3 (–≤–µ—Å 2)
2 ‚Üí 3 (–≤–µ—Å 7)
```

–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫: `[0, 1, 2, 3]`

- `dp[0] = 0`
- `dp[1] = 0 + 5 = 5`
- `dp[2] = 0 + 3 = 3`
- `dp[3] = max(5 + 2, 3 + 7) = max(7, 10) = 10`

‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å: `0 ‚Üí 2 ‚Üí 3` = 10.

---

## üéØ –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ü–æ—Ç–æ–º—É —á—Ç–æ:

1. **–ì—Ä–∞—Ñ ‚Äî DAG** ‚Äî –∑–Ω–∞—á–∏—Ç, –º–æ–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—à–∏–Ω—ã.
2. **–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫** –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–≤—Å–µ –ø—Ä–µ–¥—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–æ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã**.
3. **–ú—ã –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ** —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–æ–≤—ã–π –ø—É—Ç—å **–¥–ª–∏–Ω–Ω–µ–µ** ‚Äî —Ç–æ –µ—Å—Ç—å, **–º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ–º**.

---

## üìä –°–ª–æ–∂–Ω–æ—Å—Ç—å:

- **–í—Ä–µ–º—è**: O(V + E) ‚Äî –ª–∏–Ω–µ–π–Ω–æ–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–µ—Ä—à–∏–Ω –∏ —Ä—ë–±–µ—Ä.
- **–ü–∞–º—è—Ç—å**: O(V + E) ‚Äî –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞, –≤—Ö–æ–¥—è—â–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π, –æ—á–µ—Ä–µ–¥–∏, –º–∞—Å—Å–∏–≤–∞ `dp`.

---

## üöÄ –ò—Ç–æ–≥:

–≠—Ç–æ—Ç –∫–æ–¥:

> ‚úÖ **–ö–æ—Ä–æ—Ç–∫–∏–π** ‚Äî –≤—Å–µ–≥–æ 20 —Å—Ç—Ä–æ–∫.  
> ‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π** ‚Äî O(V + E).  
> ‚úÖ **–ù–∞–¥—ë–∂–Ω—ã–π** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è DAG.  
> ‚úÖ **–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π** ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

---

## üí° –°–æ–≤–µ—Ç:

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å **–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—É—Ç—å** ‚Äî –¥–æ–±–∞–≤—å —Å–ª–æ–≤–∞—Ä—å `parent` –∏ –æ–±–Ω–æ–≤–ª—è–π –µ–≥–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ `dp[v]`.

---

## üöÄ –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å!

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –Ω–∞ —Ç–≤–æ—ë–º –≥—Ä–∞—Ñ–µ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º. –ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏! üöÄ
